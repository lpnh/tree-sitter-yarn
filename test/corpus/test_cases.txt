=============================================================================|||
Enums
=============================================================================|||

title: Start
---

// Create a new enum, "Food". Variables of this type can store one of these
// three cases:
<<enum Food>>
    <<case Apple>>
    <<case Orange>>
    <<case Pear>>
<<endenum>>

// Declare a new variable, of this type.
<<declare $favouriteFood = Food.Apple as Food>>

// The 'as Food' can be left out, because the compiler will figure it out
<<declare $secondFavouriteFood = Food.Orange>>

// The 'Food' can be left out too, because the compiler will figure it out
<<declare $thirdFavouriteFood = .Pear>>

// Enum variables can be compared to each other
<<if $favouriteFood == Food.Apple>>
    I like apples!
<<elseif $favouriteFood == Food.Orange>>
    It's an error if you see this!
<<else>>
    It's an error if you see this!
<<endif>>

<<if $secondFavouriteFood == Food.Orange>>
    Oranges are okay in a pinch!
<<else>>
    It's an error if you see this!
<<endif>>

// Enum variables can be modified, just like all other variables
<<set $favouriteFood to Food.Orange>>

// (Just checking that we're not just evaluating all comparisons as true
// lol)
<<if $favouriteFood == Food.Apple>>
    It's an error if you see this!
<<elseif $favouriteFood != Food.Orange>>
    It's an error if you see this!
<<else>>
    I like oranges now!
<<endif>>

// You can skip the enum name if Yarn can infer the enum that it came from
<<set $favouriteFood to .Pear>>

// Yarn can infer the type of an implicitly declared variable, too:
<<set $aDifferentFood = .Apple>>

// Declare two new enums that have explicit raw values: one of numbers, and
// one of strings

<<enum Planets>>
    <<case Mercury = 1>>
    <<case Venus = 2>>
    <<case Earth = 3>>
    <<case Mars = 4>>
    <<case Jupiter = 5>>
    <<case Saturn = 6>>
    <<case Uranus = 7>>
    <<case Neptune = 8>>
<<endenum>>

<<enum QuestObjectives>>
    <<case Objective1 = "DoObjective1">>
    <<case Objective2 = "DoObjective2">>
    <<case Objective3 = "DoObjective3">>
<<endenum>>

<<if string(QuestObjectives.Objective1) == "DoObjective1">>
    ok 1
<<else>>
    error
<<endif>>

<<if number(Planets.Earth) == 3>>
    ok 2
<<else>>
    error
<<endif>>

===

-----------------------------------------------------------------------------|||

(dialogue
  (node
    (title_header
      (identifier))
    (comment)
    (comment)
    (body
      (enum_statement
        (identifier)
        (enum_case_statement
          (identifier))
        (enum_case_statement
          (identifier))
        (enum_case_statement
          (identifier)))
      (comment)
      (declare_statement
        (variable
          (identifier))
        (member_expression
          (identifier)
          (identifier))
        (identifier))
      (comment)
      (declare_statement
        (variable
          (identifier))
        (member_expression
          (identifier)
          (identifier)))
      (comment)
      (declare_statement
        (variable
          (identifier))
        (member_expression
          (identifier)))
      (comment)
      (if_statement
        (binary_expression
          (variable
            (identifier))
          (member_expression
            (identifier)
            (identifier)))
        (block
          (line_statement
            (text)))
        (else_if_clause
          (binary_expression
            (variable
              (identifier))
            (member_expression
              (identifier)
              (identifier)))
          (block
            (line_statement
              (text)))
          (else_clause
            (block
              (line_statement
                (text))))))
      (if_statement
        (binary_expression
          (variable
            (identifier))
          (member_expression
            (identifier)
            (identifier)))
        (block
          (line_statement
            (text)))
        (else_clause
          (block
            (line_statement
              (text)))))
      (comment)
      (set_statement
        (variable
          (identifier))
        (member_expression
          (identifier)
          (identifier)))
      (comment)
      (comment)
      (if_statement
        (binary_expression
          (variable
            (identifier))
          (member_expression
            (identifier)
            (identifier)))
        (block
          (line_statement
            (text)))
        (else_if_clause
          (binary_expression
            (variable
              (identifier))
            (member_expression
              (identifier)
              (identifier)))
          (block
            (line_statement
              (text)))
          (else_clause
            (block
              (line_statement
                (text))))))
      (comment)
      (set_statement
        (variable
          (identifier))
        (member_expression
          (identifier)))
      (comment)
      (set_statement
        (variable
          (identifier))
        (member_expression
          (identifier)))
      (comment)
      (comment)
      (enum_statement
        (identifier)
        (enum_case_statement
          (identifier)
          (number))
        (enum_case_statement
          (identifier)
          (number))
        (enum_case_statement
          (identifier)
          (number))
        (enum_case_statement
          (identifier)
          (number))
        (enum_case_statement
          (identifier)
          (number))
        (enum_case_statement
          (identifier)
          (number))
        (enum_case_statement
          (identifier)
          (number))
        (enum_case_statement
          (identifier)
          (number)))
      (enum_statement
        (identifier)
        (enum_case_statement
          (identifier)
          (string))
        (enum_case_statement
          (identifier)
          (string))
        (enum_case_statement
          (identifier)
          (string)))
      (if_statement
        (binary_expression
          (function_call
            (identifier)
            (arguments
              (member_expression
                (identifier)
                (identifier))))
          (string))
        (block
          (line_statement
            (text)))
        (else_clause
          (block
            (line_statement
              (text)))))
      (if_statement
        (binary_expression
          (function_call
            (identifier)
            (arguments
              (member_expression
                (identifier)
                (identifier))))
          (number))
        (block
          (line_statement
            (text)))
        (else_clause
          (block
            (line_statement
              (text))))))))

=============================================================================|||
IfStatements
=============================================================================|||

title: Start
---
<<if true>>
    Player: Hey, Sally. #line:794945
    Sally: Oh! Hi. #line:2dc39b
    Sally: You snuck up on me. #line:34de2f
    Sally: Don't do that. #line:dcc2bc
<<else>>
    Player: Hey. #line:a8e70c
    Sally: Hi. #line:305cde
<<endif>>
===

-----------------------------------------------------------------------------|||

(dialogue
  (node
    (title_header
      (identifier))
    (body
      (if_statement
        (boolean)
        (block
          (line_statement
            (text)
            (hashtag))
          (line_statement
            (text)
            (hashtag))
          (line_statement
            (text)
            (hashtag))
          (line_statement
            (text)
            (hashtag)))
        (else_clause
          (block
            (line_statement
              (text)
              (hashtag))
            (line_statement
              (text)
              (hashtag))))))))

=============================================================================|||
Jumps
=============================================================================|||

title: Start
---



===
title: NodeNameDestination
---
NodeNameDestination
// Jump to a node based on a constant expression
<<jump {"NodeNameConstantExpression"}>>
===
title: NodeNameConstantExpression
---



===
title: NodeNameVariableExpression
---
NodeNameVariableExpression
===

-----------------------------------------------------------------------------|||

(dialogue
  (node
    (title_header
      (identifier)))
  (node
    (title_header
      (identifier))
    (body
      (line_statement
        (text))
      (comment)
      (jump_statement
        (string))))
  (node
    (title_header
      (identifier)))
  (node
    (title_header
      (identifier))
    (body
      (line_statement
        (text)))))

=============================================================================|||
LinesGroups
=============================================================================|||

title: Start
---
// Scenario: A baker is selling pies.

<<declare $knows_player = false>>
<<declare $pies_bought = 0>>

// The first time we speak to the baker, she'll say one of these two lines.
// Depending on whether or not she knows the player, a different line will run.
<<once>>
    => Baker: Hey there, friend! Made some fresh pies for you! <<if $knows_player>>
    => Baker: Hey there! Fresh pies, right out of the oven! <<if not $knows_player>>
<<endonce>>

// Choose a single line to run.
// These three will only appear if the player bought a pie earlier.
=> Baker: Want another? <<if $pies_bought > 0>>
=> Baker: How about another pie? <<if $pies_bought > 0>>
=> Baker: Another pie? <<if $pies_bought > 0>>
// This line will only appear if the player bought a pie AND the baker already knows us.
=> Baker: Another pie for my best customer? <<if $knows_player && $pies_bought > 0>>
// These lines can always appear.
=> Baker: What d'ya say?
=> Baker: How about it?
=> Baker: Want one?

-> Buy Pie
    => Baker: Thank you kindly!
    => Baker: Pleasure doin' business with you!
    => Baker: Enjoy!
    <<set $pies_bought += 1>>
-> Don't Buy Pie
    => Baker: Aw, that's a shame!
    => Baker: Dang, no sale today!
    => Baker: Come back another time, then!

===
title: BakerSeesPlayer
---
=> Baker: Hey there!
=> Baker: Fresh pies!
=> Baker: Fresh and hot pies!
=> Baker: Popular pies! <<if $pies_bought > 2>>
===

-----------------------------------------------------------------------------|||

(dialogue
  (node
    (title_header
      (identifier))
    (comment)
    (body
      (declare_statement
        (variable
          (identifier))
        (boolean))
      (declare_statement
        (variable
          (identifier))
        (number))
      (comment)
      (comment)
      (once_statement
        (once_primary_clause
          (line_group_statement
            (line_group_item
              (line_statement
                (text)
                (line_condition
                  (variable
                    (identifier)))))
            (line_group_item
              (line_statement
                (text)
                (line_condition
                  (unary_expression
                    (variable
                      (identifier)))))))))
      (comment)
      (comment)
      (line_group_statement
        (line_group_item
          (line_statement
            (text)
            (line_condition
              (binary_expression
                (variable
                  (identifier))
                (number)))))
        (line_group_item
          (line_statement
            (text)
            (line_condition
              (binary_expression
                (variable
                  (identifier))
                (number)))))
        (line_group_item
          (line_statement
            (text)
            (line_condition
              (binary_expression
                (variable
                  (identifier))
                (number)))))
        (comment)
        (line_group_item
          (line_statement
            (text)
            (line_condition
              (binary_expression
                (variable
                  (identifier))
                (binary_expression
                  (variable
                    (identifier))
                  (number))))))
        (comment)
        (line_group_item
          (line_statement
            (text)))
        (line_group_item
          (line_statement
            (text)))
        (line_group_item
          (line_statement
            (text))))
      (shortcut_option_statement
        (shortcut_option
          (option_line
            (text))
          (option_body
            (line_group_statement
              (line_group_item
                (line_statement
                  (text)))
              (line_group_item
                (line_statement
                  (text)))
              (line_group_item
                (line_statement
                  (text))))
            (set_statement
              (variable
                (identifier))
              (number))))
        (shortcut_option
          (option_line
            (text))
          (option_body
            (line_group_statement
              (line_group_item
                (line_statement
                  (text)))
              (line_group_item
                (line_statement
                  (text)))
              (line_group_item
                (line_statement
                  (text)))))))))
  (node
    (title_header
      (identifier))
    (body
      (line_group_statement
        (line_group_item
          (line_statement
            (text)))
        (line_group_item
          (line_statement
            (text)))
        (line_group_item
          (line_statement
            (text)))
        (line_group_item
          (line_statement
            (text)
            (line_condition
              (binary_expression
                (variable
                  (identifier))
                (number)))))))))

=============================================================================|||
Once
=============================================================================|||

title: Start
---
<<once>>
    This content is only seen once.
<<else>>
    This content is seen on all other occasions.
<<endonce>>

<<once if $conditionA>>
    This content is only seen once, and only if $conditionA is true.
<<endonce>>

-> Option 1 <<once if $conditionB>> // only selectable once, and only if $conditionB is true
-> Option 2 <<once>> // only selectable once
-> Option 3 <<if $conditionB>> // only selectable if $conditionB is true
-> Option 4 // always selectable

=> Item 1 <<once>> // will only appear once
=> Item 2 <<once if $conditionC>> // will only appear once, and only if $conditionC is true
=> Item 3 <<if $conditionC>> // will only appear if $conditionC is true
=> Item 4 // may always appear

Line 1 <<once>> // line will only run once
Line 2 <<once if $conditionD>> // line will only run once, and only if $conditionD is true
Line 3 <<if $conditionD>> // line will only run if $conditionD is true
Line 4 // line will always run
===

-----------------------------------------------------------------------------|||

(dialogue
  (node
    (title_header
      (identifier))
    (body
      (once_statement
        (once_primary_clause
          (line_statement
            (text)))
        (once_alternate_clause
          (line_statement
            (text))))
      (once_statement
        (variable
          (identifier))
        (once_primary_clause
          (line_statement
            (text))))
      (shortcut_option_statement
        (shortcut_option
          (option_line
            (text)
            (line_condition
              (variable
                (identifier)))
            (comment)))
        (shortcut_option
          (option_line
            (text)
            (line_condition)
            (comment)))
        (shortcut_option
          (option_line
            (text)
            (line_condition
              (variable
                (identifier)))
            (comment)))
        (shortcut_option
          (option_line
            (text))))
      (line_group_statement
        (line_group_item
          (line_statement
            (text)
            (line_condition)
            (comment)))
        (line_group_item
          (line_statement
            (text)
            (line_condition
              (variable
                (identifier)))
            (comment)))
        (line_group_item
          (line_statement
            (text)
            (line_condition
              (variable
                (identifier)))
            (comment)))
        (line_group_item
          (line_statement
            (text))))
      (line_statement
        (text)
        (line_condition)
        (comment))
      (line_statement
        (text)
        (line_condition
          (variable
            (identifier)))
        (comment))
      (line_statement
        (text)
        (line_condition
          (variable
            (identifier)))
        (comment))
      (line_statement
        (text)))))
